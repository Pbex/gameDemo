window.__require=function t(e,i,n){function o(c,a){if(!i[c]){if(!e[c]){var r=c.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+c+"'")}}var l=i[c]={exports:{}};e[c][0].call(l.exports,function(t){return o(e[c][1][t]||t)},l,l.exports,t,e,i,n)}return i[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<n.length;c++)o(n[c]);return o}({AI:[function(t,e,i){"use strict";cc._RF.push(e,"1391aI59vdPF4iyltwVmYZX","AI");var n=!0,o=0,s=0;cc.Class({extends:cc.Component,properties:{gameManager:cc.Node,player:cc.Node,doingSth:!1,canvas:cc.Node,bullet:cc.Prefab,coolDownTime:5,chargingTime:2,chargingCurvRate:2,bulletSpeed:150,speed:100},moveDown:function(){var t=this.node.position.x-this.player.position.x;if(t<10&&t>-10){this.doingSth=!0;var e=cc.callFunc(function(t){this.doingSth=!1,this.getComponent(cc.Animation).play("idle")},this,!1),i=this.node.position,n=cc.moveTo(this.chargingTime,i);n.easing(cc.easeElasticOut(this.chargingCurvRate));var o=this.player.position,s=cc.moveTo(this.chargingTime,o);s.easing(cc.easeOut(this.chargingCurvRate));var c=cc.sequence(s,n,e);this.node.runAction(c),this.getComponent(cc.Animation).play("charge")}},moveHorizontal:function(t){this.node.position=n?new cc.Vec2(this.node.position.x-t*this.speed,this.node.position.y):new cc.Vec2(this.node.position.x+t*this.speed,this.node.position.y),this.node.position.x>o?n=!0:this.node.position.x<-o&&(n=!1)},initPos:function(){this.doingSth=!0;var t=cc.v2(this.node.position.x,this.canvas.height/2),e=cc.callFunc(function(t){this.doingSth=!1},this,!1),i=cc.sequence(cc.moveTo(2,t),e);this.node.runAction(i)},movingLogic:function(t){this.moveHorizontal(t),this.moveDown()},generateSingleBullet:function(t,e){var i=cc.instantiate(this.bullet);this.canvas.addChild(i),1==t?i.setPosition(cc.v2(this.canvas.width/2,this.player.position.y+e)):i.setPosition(cc.v2(-this.canvas.width/2,this.player.position.y+e)),i.getComponent("Bullet").direction=t,i.getComponent("Bullet").gameManager=this.gameManager,i.getComponent("Bullet").switchDir(),i.getComponent("Bullet").speed=this.bulletSpeed,i.getComponent("Bullet").maxX=this.canvas.width,i.getComponent("Bullet").maxY=this.canvas.height},generateBullets:function(){this.getComponent(cc.Animation).play("charge");for(var t=-120;t<121;t+=60)this.generateSingleBullet(1,t),this.generateSingleBullet(3,t);this.doingSth=!1},skillChoice:function(t){if(s>this.coolDownTime){this.doingSth=!0;switch(Math.floor(1*(Math.random()+.5))){case 0:this.generateBullets();break;default:this.doingSth=!1}s=0}s+=t},onLoad:function(){this.getComponent(cc.Animation).play("idle"),o=this.canvas.width/2},onEnable:function(){this.initPos()},start:function(){},update:function(t){this.doingSth||(this.movingLogic(t),this.skillChoice(t))}}),cc._RF.pop()},{}],BossProperty:[function(t,e,i){"use strict";cc._RF.push(e,"236f5NiMu9ETq67VnzUzFlS","BossProperty");cc.Class({extends:cc.Component,properties:{health:500,state1:250,state2:100,crashHandler:cc.Node,blinking:!1},onCrash:function(){this.crashHandler.getComponent("OnCrash").onCrash()},onCollisionEnter:function(t,e){if("playerBullet"==t.node.group?this.health--:"bullet"==t.node.group?(this.health-=3,t.getComponent("Bullet").onHit()):"crash"==t.node.group&&(this.health-=5,e.getComponent("BossProperty").onCrash()),!this.blinking){this.blinking=!0;var i=cc.callFunc(function(){this.blinking=!1},this,!1),n=cc.sequence(cc.blink(.3,3),i);this.node.runAction(n)}this.health<0&&cc.director.loadScene("GameWin")},start:function(){},update:function(t){}}),cc._RF.pop()},{}],Bullet:[function(t,e,i){"use strict";cc._RF.push(e,"a6c9fa1FspNqotG3sxR2gro","Bullet"),cc.Class({extends:cc.Component,properties:{stopBullet:!1},onHit:function(){var t=this.getComponent(cc.Animation);this.stopBullet=!0,this.gameManager.getComponent("GameManager").bulletDecrease(),t.play("stone_break").wrapMode=cc.WrapMode.Normal},onHitEnd:function(){this.node.destroy()},moveBullet:function(t){switch((this.node.position.y<-this.maxY||this.node.position.x<-this.maxX||this.node.position.y>this.maxY||this.node.position.x>this.maxX)&&(this.gameManager.getComponent("GameManager").bulletDecrease(),this.node.destroy()),this.direction){case 0:this.node.position=new cc.Vec2(this.node.position.x,this.node.position.y-this.speed*t);break;case 1:this.node.position=new cc.Vec2(this.node.position.x-this.speed*t,this.node.position.y);break;case 2:this.node.position=new cc.Vec2(this.node.position.x,this.node.position.y+this.speed*t);break;case 3:this.node.position=new cc.Vec2(this.node.position.x+this.speed*t,this.node.position.y)}},switchDir:function(){switch(this.gameManager.getComponent("GameManager").bulletAdd(),this.direction){case 1:this.node.angle=270;break;case 2:this.node.angle=180;break;case 3:this.node.angle=90}},onLoad:function(){var t=this.getComponent(cc.Animation);t.play().wrapMode=cc.WrapMode.Loop,t.play().repeatCount=1/0},start:function(){},update:function(t){this.stopBullet||this.moveBullet(t)}}),cc._RF.pop()},{}],Button:[function(t,e,i){"use strict";cc._RF.push(e,"b3c41K1Y0hIbaVfsXSZzz8N","Button"),cc.Class({extends:cc.Component,properties:{startButton:cc.Button,helpButton:cc.Button,quitButton:cc.Button},onBtnStart:function(){cc.director.loadScene("GameItself")},onBtnhelp:function(){cc.director.loadScene("Help")},onBtnQuit:function(){cc.game.end()},start:function(){}}),cc._RF.pop()},{}],Follower:[function(t,e,i){"use strict";cc._RF.push(e,"b201eV55DJJkIDNF7dw/UBN","Follower");var n=0;new cc.v2(0,0);cc.Class({extends:cc.Component,properties:{target:{default:null,type:cc.Node},gameManager:{default:null,type:cc.Node}},move:function(){this.node.position=cc.v2(this.node.position.x+(this.target.position.x-this.node.position.x)*n,this.node.position.y+(this.target.position.y-this.node.position.y)*n)},onLoad:function(){n=this.gameManager.getComponent("GameManager").lerpVal},start:function(){},update:function(t){this.move()}}),cc._RF.pop()},{}],GameLogic:[function(t,e,i){"use strict";cc._RF.push(e,"4a5aa0mmVFLVK14FCz4uZUc","GameLogic");var n=0,o=0,s=0,c=0,a=0,r=0,h=0,l=!0;cc.Class({extends:cc.Component,properties:{gameManager:{default:null,type:cc.Node},slowStone:cc.Prefab,normalStone:cc.Prefab,fastStone:cc.Prefab,player:cc.Node,playerBullet:cc.Prefab,bulletNum:1,skillActor:cc.Node,directionSwapTime:30,bulletSpeed:1,bulletGenerateTime:1,skillChoiceUI:cc.Node,radar:cc.Node,boss:cc.Node,bossGenerateTime:100,generateBullets:!0},addSpeed:function(){this.bulletGenerateTime*=.85},generateRandomPos:function(){var t=0,e=0;switch(c){case 0:t=(Math.random()-.5)*this.node.width,e=this.node.height/2;break;case 1:t=this.node.width/2,e=(Math.random()-.5)*this.node.height;break;case 2:t=(Math.random()-.5)*this.node.width,e=-this.node.height/2;break;case 3:t=-this.node.width/2,e=(Math.random()-.5)*this.node.height}return cc.v2(t,e)},spawnNewBullets:function(t){switch(t){case 4:var e=cc.instantiate(this.fastStone);break;case 2:e=cc.instantiate(this.normalStone);break;case 1:e=cc.instantiate(this.slowStone)}this.node.addChild(e),e.setPosition(this.generateRandomPos()),e.getComponent("Bullet").direction=c,e.getComponent("Bullet").gameManager=this.gameManager,e.getComponent("Bullet").switchDir(),e.getComponent("Bullet").speed=this.bulletSpeed*t,e.getComponent("Bullet").maxX=this.node.width,e.getComponent("Bullet").maxY=this.node.height,console.log("spwan bullet done")},stopBulletGeneration:function(){this.generateBullets=!1},startBulletGeneration:function(){this.generateBullets=!0},bulletGenerator:function(t){o>this.directionSwapTime&&(c++,o=0,c%=4,this.addSpeed()),n>this.bulletGenerateTime&&(n=0,s<4?this.spawnNewBullets(4):s<7?this.spawnNewBullets(2):this.spawnNewBullets(1),s++,s%=10),n+=t,o+=t},skillChoice:function(){this.skillChoiceUI.active=!0,this.skillChoiceUI.getComponent("SkillManager").gameManager=this},generateBullet:function(t){if(r+=t,(a+=t)>.7&&r>.1){var e=cc.instantiate(this.playerBullet);this.node.addChild(e),e.setPosition(this.player.position),e.getComponent("PlayerBullet").moveBullet(this.boss.position),r=0,++h==this.bulletNum&&(a=0,h=0)}},startShooting:function(){this.isShooting=!0},stopShooting:function(){this.isShooting=!1},bossActive:function(){this.gameManager.getComponent("GameManager").getGameTime()>this.bossGenerateTime&&(this.stopBulletGeneration(),this.activeRadar(),l&&this.gameManager.getComponent("GameManager").getBullet()<10&&(this.closeRadar(),this.skillChoice(),l=!1,this.gameManager.getComponent("GameManager").setGameTime(0)))},activeRadar:function(){this.radar.active=!0},closeRadar:function(){this.radar.active=!this.radar.active},onLoad:function(){},update:function(t){this.generateBullets&&this.bulletGenerator(t),this.bossActive(),this.isShooting&&this.generateBullet(t)}}),cc._RF.pop()},{}],GameManager:[function(t,e,i){"use strict";cc._RF.push(e,"22720Fxj1NEkJ6WbU58Ws2E","GameManager");var n=0;new Array(500,1e3,2e3);cc.Class({extends:cc.Component,properties:{health:3,lerpVal:.5,gameTime:0,target:0,bulletCount:0,playerLifeLabel:cc.Label},decreaseHealth:function(){this.health--,console.log(this.health)},getHealth:function(){return this.health},addGameTime:function(){this.gameTime++},getGameTime:function(){return this.gameTime},setGameTime:function(t){this.gameTime=t},bulletAdd:function(){this.bulletCount++},bulletDecrease:function(){console.log(this.bulletCount),this.bulletCount--},getBullet:function(){return this.bulletCount},gameOver:function(){cc.director.loadScene("GameOver")},onLoad:function(){var t=cc.director.getCollisionManager();t.enabled=!0,t.enabledDebugDraw=!1},start:function(){},update:function(t){(n+=t)>1&&(this.addGameTime(),n=0),this.playerLifeLabel.string="Life: "+(this.getHealth()+1)}}),cc._RF.pop()},{}],JoyStick:[function(t,e,i){"use strict";cc._RF.push(e,"d7421T6s2lKdpdutrvJ1soW","JoyStick"),cc.Class({extends:cc.Component,properties:{stick:{type:cc.Node,default:null},max_r:80,stopMoving:!0},onLoad:function(){this.start_pos=cc.v2(0,0),this.stick.setPosition(this.start_pos),this.dir=cc.v2(0,0),this.stick.on(cc.Node.EventType.TOUCH_START,function(){}.bind(this),this),this.stick.on(cc.Node.EventType.TOUCH_MOVE,function(t){this.stopMoving=!1;var e=t.getLocation(),i=this.node.convertToNodeSpaceAR(e),n=i.mag();this.dir.x=i.x/n,this.dir.y=i.y/n,n>this.max_r&&(i.x=i.x*this.max_r/n,i.y=i.y*this.max_r/n),this.stick.setPosition(i)}.bind(this),this),this.stick.on(cc.Node.EventType.TOUCH_END,function(){this.stick.setPosition(this.start_pos),this.stopMoving=!0}.bind(this),this),this.stick.on(cc.Node.EventType.TOUCH_CANCEL,function(){this.stick.setPosition(this.start_pos),this.stopMoving=!0}.bind(this),this)},start:function(){}}),cc._RF.pop()},{}],OnCrash:[function(t,e,i){"use strict";cc._RF.push(e,"6a9e6Ji9FZNkJYwfDB5fTSs","OnCrash"),cc.Class({extends:cc.Component,properties:{crash0:cc.Prefab,crash1:cc.Prefab,crash2:cc.Prefab,crash3:cc.Prefab,crash4:cc.Prefab,crash5:cc.Prefab},onCrash:function(){switch(Math.floor(6*Math.random())){case 0:this.node.addChild(cc.instantiate(this.crash0));break;case 1:this.node.addChild(cc.instantiate(this.crash1));break;case 2:this.node.addChild(cc.instantiate(this.crash2));break;case 3:this.node.addChild(cc.instantiate(this.crash3));break;case 4:this.node.addChild(cc.instantiate(this.crash4));break;case 5:this.node.addChild(cc.instantiate(this.crash5))}},start:function(){}}),cc._RF.pop()},{}],PlayerBullet:[function(t,e,i){"use strict";cc._RF.push(e,"f06fdarTQ1IoKtfpAC6NBmp","PlayerBullet"),cc.Class({extends:cc.Component,properties:{},onCollisionEnter:function(t,e){this.node.destroy()},moveBullet:function(t){var e=cc.callFunc(function(t){this.node.destroy()},this,!1);this.node.runAction(cc.sequence(cc.moveTo(1,t),e))},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],PlayerCollider:[function(t,e,i){"use strict";cc._RF.push(e,"450e9GvU/NCTICQys89Fb/u","PlayerCollider");cc.Class({extends:cc.Component,properties:{gameManager:{default:null,type:cc.Node},stick:{default:null,type:cc.Node},id:0,untouchableTimer:0},onCollisionEnter:function(t,e){if("bullet"==t.node.group&&t.getComponent("Bullet").onHit(),console.log("collision enter"),console.log("self.node.group",e.node.group),"player"==e.node.group){console.log("decrease health call"),this.gameManager.getComponent("GameManager").decreaseHealth(),e.node.group="default";var i=cc.blink(5,20);e.node.runAction(i),cc.director.getScheduler().schedule(this.touchable,this,5,1,0,!1)}},touchable:function(){this.node.group="player"},destoryCall:function(){0==this.id&&this.gameOver()},gameOver:function(){this.gameManager.getComponent("GameManager").gameOver()},onLoad:function(){var t=this.getComponent(cc.Animation).play();t.wrapMode=cc.WrapMode.Loop,t.repeatCount=1/0},start:function(){},update:function(t){var e=180*Math.atan2(this.stick.getComponent("JoyStick").dir.y,this.stick.getComponent("JoyStick").dir.x)/Math.PI;(e-=90,this.node.angle=e,this.gameManager.getComponent("GameManager").getHealth()==this.id)&&this.getComponent(cc.Animation).play("defeated")}}),cc._RF.pop()},{}],PlayerControl:[function(t,e,i){"use strict";cc._RF.push(e,"42c9bJ4n1lP/L7+iXqR+K3Y","PlayerControl"),cc.Class({extends:cc.Component,properties:{gameManager:{default:null,type:cc.Node},canvas:{default:null,type:cc.Node},stick:{default:null,type:cc.Node},speed:80,playerIndex:0,boss:cc.Node},start:function(){},update:function(t){if(!(this.stick.getComponent("JoyStick").dir.mag()<.5||this.stick.getComponent("JoyStick").stopMoving)){var e=this.stick.getComponent("JoyStick").dir.x*this.speed,i=this.stick.getComponent("JoyStick").dir.y*this.speed;this.node.x+=e*t,this.node.y+=i*t,this.node.x>this.canvas.width/2&&(this.node.x=this.canvas.width/2),this.node.x<-this.canvas.width/2&&(this.node.x=-this.canvas.width/2),this.node.y>this.canvas.height/2&&(this.node.y=this.canvas.height/2),this.node.y<-this.canvas.height/2&&(this.node.y=-this.canvas.height/2)}}}),cc._RF.pop()},{}],PlayerSkill:[function(t,e,i){"use strict";cc._RF.push(e,"35bceXevX5Iwqr6vHY18ZTR","PlayerSkill"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],SkillActor:[function(t,e,i){"use strict";cc._RF.push(e,"ae49cTVxj5PZZIaVDwb0Gyu","SkillActor");var n=0,o=!1;cc.Class({extends:cc.Component,properties:{boss:cc.Node,crashIcon:cc.Node,crash:cc.Node,logic:cc.Node},activateSkill:function(t){switch(t){case 0:this.crashIcon.active=!0;break;case 1:this.logic.getComponent("GameLogic").bulletNum++}this.boss.active=!0,this.logic.getComponent("GameLogic").startShooting()},crashStart:function(){o=!0,this.crash.active=!0,this.logic.getComponent("GameLogic").stopShooting(),console.log("speed problem"),this.node.parent.getComponent("PlayerControl").speed*=4,console.log("speed no problem"),this.node.parent.group="default",this.node.group="crash",cc.director.getScheduler().schedule(this.blink,this,3,1,0,!1)},blink:function(){var t=cc.blink(2,10);this.crash.runAction(t)},crashEnd:function(){this.crash.active=!1,this.node.group="default",this.node.parent.group="player",this.node.parent.getComponent("PlayerControl").speed/=4,this.logic.getComponent("GameLogic").startShooting(),o=!1},start:function(){},update:function(t){o&&(n+=t)>10&&(n=0,this.crashEnd())}}),cc._RF.pop()},{}],SkillCrash:[function(t,e,i){"use strict";cc._RF.push(e,"e1b6ciYE4JMRZT92VTBJsoE","SkillCrash");var n=0;cc.Class({extends:cc.Component,properties:{coolDownTime:5,progressBar:cc.ProgressBar,actor:cc.Node},skillTouched:function(){this.progressBar.progress>=1&&(this.actor.getComponent("SkillActor").crashStart(),n=0)},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.skillTouched,this)},start:function(){},update:function(t){(n+=t)>this.coolDownTime?this.progressBar.progress=1:this.progressBar.progress=n/this.coolDownTime}}),cc._RF.pop()},{}],SkillManager:[function(t,e,i){"use strict";cc._RF.push(e,"01f24V8UhxBopKgVu3ONzbB","SkillManager");var n=-1;cc.Class({extends:cc.Component,properties:{describe:cc.Label,skillActor:cc.Node},setDescribe:function(t){this.describe.string=t},clickReturn:function(t){t==n&&(this.skillActor.getComponent("SkillActor").activateSkill(t),this.gameManager.closeRadar(),this.node.active=!1),n=t},start:function(){}}),cc._RF.pop()},{}],SkillReturn:[function(t,e,i){"use strict";cc._RF.push(e,"b84b5qwSW1BZZLJHbFClbfE","SkillReturn"),cc.Class({extends:cc.Component,properties:{id:cc.Integer,describe:"",manager:cc.Node},skillTouched:function(){this.manager.getComponent("SkillManager").setDescribe(this.describe),this.manager.getComponent("SkillManager").clickReturn(this.id)},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.skillTouched,this)},start:function(){}}),cc._RF.pop()},{}],Timer:[function(t,e,i){"use strict";cc._RF.push(e,"e5f6cdpEfNJM4dD+/0StFk2","Timer");cc.Class({extends:cc.Component,properties:{timer:0},start:function(){},update:function(t){this.timer+=t,this.timer>1&&this.node.destroy()}}),cc._RF.pop()},{}],buttonReturn:[function(t,e,i){"use strict";cc._RF.push(e,"0aa93OGKPROUJNiWk2hNh3k","buttonReturn"),cc.Class({extends:cc.Component,properties:{returnButton:cc.Button},onBtnReturn:function(){cc.director.loadScene("GameMenu")},start:function(){}}),cc._RF.pop()},{}],helpStrings:[function(t,e,i){"use strict";cc._RF.push(e,"679e0rKZlVHZ40jjYE7Xbyt","helpStrings");var n=0;cc.Class({extends:cc.Component,properties:{guideString:[cc.String],label:cc.Label,JoyStick:cc.Node,stone:cc.Node,radar:cc.Node},setState:function(){switch(console.log("set State"+n),++n){case 0:this.label.string=this.guideString[n],this.JoyStick.active=!0,this.stone.active=!1,this.radar.active=!1;case 1:this.label.string=this.guideString[n],this.JoyStick.active=!1,this.stone.active=!0,this.radar.active=!1;break;case 2:this.label.string=this.guideString[n],this.JoyStick.active=!1,this.stone.active=!1,this.radar.active=!0;break;case 3:cc.director.loadScene("GameMenu")}},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.setState,this),this.guideString=["\u6447\u6746\u63a7\u5236\u79fb\u52a8","\u5728\u65c5\u884c\u65f6\u4f1a\u9047\u5230\u9668\u77f3\uff0c\u78b0\u649e\u9668\u77f3\u4f1a\u635f\u5931\u8fd0\u8f93\u4ed3\uff0c\n\u82e5\u6ca1\u6709\u8fd0\u8f93\u4ed3\u53ef\u4ee5\u635f\u5931\u4e86\uff0c\u98de\u8239\u5c31\u4f1a\u7206\u70b8","\u96f7\u8fbe\uff1a\u5b87\u5b99\u4e2d\u5b58\u5728\u7740\u5371\u9669\u7684\u4e1c\u897f\uff0c\n\u96f7\u8fbe\u51fa\u73b0\u53cd\u5e94\u4ee3\u8868\u6709\u672a\u77e5\u70ed\u6e90\u63a5\u8fd1"],this.label.string=this.guideString[n]},start:function(){}}),cc._RF.pop()},{}]},{},["Timer","AI","BossProperty","OnCrash","Bullet","Button","GameLogic","GameManager","JoyStick","buttonReturn","helpStrings","Follower","PlayerBullet","PlayerCollider","PlayerControl","PlayerSkill","SkillActor","SkillCrash","SkillManager","SkillReturn"]);