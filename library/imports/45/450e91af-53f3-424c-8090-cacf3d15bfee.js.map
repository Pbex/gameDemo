{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Scripts\\player/assets\\Scripts\\player\\PlayerCollider.js"],"names":["untouchableTime","isUntouchable","cc","Class","extends","Component","properties","gameManager","default","type","Node","stick","id","untouchableTimer","onCollisionEnter","other","self","node","group","getComponent","onHit","console","log","decreaseHealth","director","getScheduler","schedule","touchable","destoryCall","gameOver","onLoad","anim","Animation","animState","play","wrapMode","WrapMode","Loop","repeatCount","Infinity","start","update","dt","angel","Math","atan2","dir","y","x","degree","PI","angle","getHealth"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAIA,kBAAkB,CAAtB;AACA,IAAIC,gBAAgB,KAApB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ;AAFA,SAhBL;AAoBRC,eAAO;AACHH,qBAAS,IADN;AAEHC,kBAAMP,GAAGQ;AAFN,SApBC;AAwBRE,YAAI,CAxBI;AAyBRC,0BAAkB;AAzBV,KAHP;;AA+BL;AACAC,sBAAkB,0BAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACrC,YAAID,MAAME,IAAN,CAAWC,KAAX,IAAoB,QAAxB,EAAkC;AAClC;AACIH,sBAAMI,YAAN,CAAmB,QAAnB,EAA6BC,KAA7B;AACH;AACDC,gBAAQC,GAAR,CAAY,iBAAZ;AACA,YAAIN,KAAKE,KAAL,IAAc,QAAlB,EAA4B;AACxB,iBAAKX,WAAL,CAAiBY,YAAjB,CAA8B,aAA9B,EAA6CI,cAA7C;AACAP,iBAAKE,KAAL,GAAa,SAAb;AACAG,oBAAQC,GAAR,CAAY,mBAAZ;;AAEApB,eAAGsB,QAAH,CAAYC,YAAZ,GAA2BC,QAA3B,CAAoC,KAAKC,SAAL,EAApC,EAAsD,IAAtD,EAA4D,CAA5D,EAA+D,CAA/D,EAAiE,CAAjE,EAAmE,KAAnE;AACAN,oBAAQC,GAAR,CAAY,mBAAZ;AACH;AACJ,KA9CI;;AAgDLK,aAhDK,uBAgDO;AACR,aAAKV,IAAL,CAAUC,KAAV,GAAkB,QAAlB;AACH,KAlDI;AAoDLU,eApDK,yBAoDS;AACV,YAAI,KAAKhB,EAAL,IAAW,CAAf,EAAkB;AACd,iBAAKiB,QAAL;AACH;AACJ,KAxDI;AA0DLA,YA1DK,sBA0DM;AACP,aAAKtB,WAAL,CAAiBY,YAAjB,CAA8B,aAA9B,EAA6CU,QAA7C;AACH,KA5DI;AA8DLC,UA9DK,oBA8DI;AACL,YAAIC,OAAO,KAAKZ,YAAL,CAAkBjB,GAAG8B,SAArB,CAAX;AACA,YAAIC,YAAYF,KAAKG,IAAL,EAAhB;AACAD,kBAAUE,QAAV,GAAqBjC,GAAGkC,QAAH,CAAYC,IAAjC;AACAJ,kBAAUK,WAAV,GAAwBC,QAAxB;AACH,KAnEI;AAqELC,SArEK,mBAqEG,CAEP,CAvEI;AAyELC,UAzEK,kBAyEEC,EAzEF,EAyEM;AACP;AACA,YAAIC,QAAQC,KAAKC,KAAL,CAAW,KAAKlC,KAAL,CAAWQ,YAAX,CAAwB,UAAxB,EAAoC2B,GAApC,CAAwCC,CAAnD,EACR,KAAKpC,KAAL,CAAWQ,YAAX,CAAwB,UAAxB,EAAoC2B,GAApC,CAAwCE,CADhC,CAAZ;AAEA,YAAIC,SAASN,QAAQ,GAAR,GAAcC,KAAKM,EAAhC;AACAD,iBAASA,SAAS,EAAlB;AACA,aAAKhC,IAAL,CAAUkC,KAAV,GAAkBF,MAAlB;;AAEA;;AAEA,YAAI,KAAK1C,WAAL,CAAiBY,YAAjB,CAA8B,aAA9B,EAA6CiC,SAA7C,MAA4D,KAAKxC,EAArE,EAAyE;AACrE,gBAAImB,OAAO,KAAKZ,YAAL,CAAkBjB,GAAG8B,SAArB,CAAX;AACAD,iBAAKG,IAAL,CAAU,UAAV;AACH;AAEJ;AAxFI,CAAT","file":"PlayerCollider.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\player","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar untouchableTime = 5;\r\nvar isUntouchable = false;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        gameManager: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        stick: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        id: 0,\r\n        untouchableTimer: 0,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onCollisionEnter: function (other, self) {\r\n        if (other.node.group == 'bullet') //检测碰撞组\r\n        {\r\n            other.getComponent('Bullet').onHit();\r\n        }\r\n        console.log('collision enter');\r\n        if (self.group == 'player') {\r\n            this.gameManager.getComponent('GameManager').decreaseHealth();\r\n            self.group = 'default';\r\n            console.log('scheduler problem');\r\n            \r\n            cc.director.getScheduler().schedule(this.touchable(), this, 5, 1,0,false);\r\n            console.log('scheduler problem');\r\n        }\r\n    },\r\n\r\n    touchable() {\r\n        this.node.group = 'player';\r\n    },\r\n\r\n    destoryCall() {\r\n        if (this.id == 0) {\r\n            this.gameOver();\r\n        }\r\n    },\r\n\r\n    gameOver() {\r\n        this.gameManager.getComponent('GameManager').gameOver();\r\n    },\r\n\r\n    onLoad() {\r\n        var anim = this.getComponent(cc.Animation);\r\n        var animState = anim.play();\r\n        animState.wrapMode = cc.WrapMode.Loop;\r\n        animState.repeatCount = Infinity;\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    update(dt) {\r\n        // Math.atan2(y,x) 计算出来的结果angel是一个弧度值 数学的弧度是逆时针的 而游戏中是顺时针的\r\n        var angel = Math.atan2(this.stick.getComponent('JoyStick').dir.y,\r\n            this.stick.getComponent('JoyStick').dir.x);\r\n        var degree = angel * 180 / Math.PI;\r\n        degree = degree - 90;\r\n        this.node.angle = degree;\r\n\r\n        // console.log(this.gameManager.getComponent('GameManager').getHealth());\r\n\r\n        if (this.gameManager.getComponent('GameManager').getHealth() == this.id) {\r\n            var anim = this.getComponent(cc.Animation);\r\n            anim.play('defeated');\r\n        }\r\n\r\n    },\r\n});\r\n"]}