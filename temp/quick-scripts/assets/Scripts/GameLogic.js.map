{"version":3,"sources":["GameLogic.js"],"names":["bulletTimer","directionTimer","counter","bulletDirection","cc","Class","extends","Component","properties","gameManager","default","type","Node","bullet","Prefab","directionSwapTime","bulletSpeed","bulletGenerateTime","scoreLabel","Label","generateBullets","addSpeed","generateRandomPos","randX","randY","Math","random","node","width","height","v2","spawnNewBullets","speedUp","newBullet","instantiate","addChild","setPosition","getComponent","direction","switchDir","speed","maxX","maxY","bulletGenerator","dt","console","log","addScore","string","getScore","onLoad","update"],"mappings":"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","file":"GameLogic.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nvar bulletTimer = 0;\r\nvar directionTimer = 0;\r\nvar counter=0;\r\nvar bulletDirection= 0;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        gameManager: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n\r\n        bullet: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n\r\n        directionSwapTime:30,\r\n        bulletSpeed: 1,\r\n        bulletGenerateTime: 1,\r\n\r\n        scoreLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        \r\n        generateBullets:true,\r\n    },\r\n\r\n    addSpeed(){\r\n        this.bulletGenerateTime-=0.1;\r\n        this.bulletSpeed+=0.2;\r\n    },\r\n\r\n    generateRandomPos: function () {\r\n        var randX = 0;\r\n        var randY = 0;\r\n        switch (bulletDirection) {\r\n            case 0://bullets come from up\r\n                randX = (Math.random() - 0.5) * this.node.width;\r\n                randY = this.node.height / 2;\r\n                break;\r\n            case 1://bullets come from right\r\n                randX = this.node.width / 2;\r\n                randY = (Math.random() - 0.5) * this.node.height;\r\n                break;\r\n            case 2://bullets come from down\r\n                randX = (Math.random() - 0.5) * this.node.width;\r\n                randY = -this.node.height / 2;\r\n                break;\r\n            case 3://bullets come from left\r\n                randX = -this.node.width / 2;\r\n                randY = (Math.random() - 0.5) * this.node.height;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        return cc.v2(randX, randY);\r\n    },\r\n\r\n    spawnNewBullets: function (speedUp) {\r\n        var newBullet = cc.instantiate(this.bullet);\r\n        this.node.addChild(newBullet);\r\n        newBullet.setPosition(this.generateRandomPos());\r\n        //transfer direction to every bullet\r\n        newBullet.getComponent('Bullet').direction = bulletDirection;\r\n        newBullet.getComponent('Bullet').switchDir();\r\n        newBullet.getComponent('Bullet').speed = this.bulletSpeed*speedUp;\r\n        newBullet.getComponent('Bullet').maxX = this.node.width;\r\n        newBullet.getComponent('Bullet').maxY = this.node.height;\r\n    },\r\n    bulletGenerator(dt){\r\n        if (directionTimer>this.directionSwapTime) {\r\n            console.log('direction changed');\r\n            \r\n            bulletDirection++;\r\n            directionTimer=0;\r\n            bulletDirection%=4;\r\n        }\r\n        if (bulletTimer > this.bulletGenerateTime) {\r\n            bulletTimer = 0;\r\n            if (counter<4) {\r\n                this.spawnNewBullets(4);\r\n            }else if (counter<7) {\r\n                this.spawnNewBullets(2);\r\n            }else{\r\n                this.spawnNewBullets(1);\r\n            }\r\n            counter++;\r\n            counter%=10;\r\n            this.gameManager.getComponent('GameManager').addScore();\r\n            this.scoreLabel.string = 'Score: ' + this.gameManager.getComponent('GameManager').getScore();\r\n        }\r\n        bulletTimer += dt;\r\n        directionTimer+=dt;\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        this.scoreLabel.string = 'Score: ' + this.gameManager.getComponent('GameManager').getScore();\r\n    },\r\n\r\n    // start () {\r\n\r\n    // },\r\n    \r\n    update(dt) {\r\n        if (this.generateBullets) {\r\n            this.bulletGenerator(dt);\r\n        }\r\n    },\r\n});\r\n"]}